2025-07-18 16:11:54 [ERROR] fetch_oracle_customer: Failed to connect to Oracle DB: ORA-12170: Cannot connect. TCP connect timeout of 20s for host 192.168.5.45 port 1606. (CONNECTION_ID=0JM3RhLwRsWM1pgSojq2MQ==)
Help: https://docs.oracle.com/error-help/db/ora-12170/
Traceback (most recent call last):
  File "C:\Users\delin\Documents\codes\pwani_finance\data_ingestion\fetch_oracle_customer.py", line 20, in connect
    self.connection = oracledb.connect(
                      ^^^^^^^^^^^^^^^^^
  File "C:\Users\delin\Documents\codes\pwani_finance\financePwani\Lib\site-packages\oracledb\connection.py", line 1276, in connect
    return conn_class(dsn=dsn, pool=pool, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\delin\Documents\codes\pwani_finance\financePwani\Lib\site-packages\oracledb\connection.py", line 653, in __init__
    impl.connect(params_impl, pool_impl)
  File "src/oracledb/impl/thick/connection.pyx", line 510, in oracledb.thick_impl.ThickConnImpl.connect
  File "src/oracledb/impl/thick/utils.pyx", line 474, in oracledb.thick_impl._raise_from_info
oracledb.exceptions.DatabaseError: ORA-12170: Cannot connect. TCP connect timeout of 20s for host 192.168.5.45 port 1606. (CONNECTION_ID=0JM3RhLwRsWM1pgSojq2MQ==)
Help: https://docs.oracle.com/error-help/db/ora-12170/
2025-07-18 17:13:27 [INFO] fetch_oracle_customer: connection established
2025-07-18 17:23:02 [ERROR] fetch_oracle_customer: Failed to fetch invoice data: DPY-4011: the database or network closed the connection
DPI-1080: connection was closed by ORA-03113
ORA-03113: end-of-file on communication channel
Process ID: 2163902
Session ID: 67 Serial number: 30878
Help: https://docs.oracle.com/error-help/db/ora-03113/
Traceback (most recent call last):
  File "C:\Users\delin\Documents\codes\pwani_finance\data_ingestion\fetch_oracle_customer.py", line 78, in fetch_invoice_data
    df = self.cursor.execute(query)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\delin\Documents\codes\pwani_finance\financePwani\Lib\site-packages\oracledb\cursor.py", line 708, in execute
    impl.execute(self)
  File "src/oracledb/impl/thick/cursor.pyx", line 318, in oracledb.thick_impl.ThickCursorImpl.execute
  File "src/oracledb/impl/thick/utils.pyx", line 484, in oracledb.thick_impl._raise_from_odpi
  File "src/oracledb/impl/thick/utils.pyx", line 474, in oracledb.thick_impl._raise_from_info
oracledb.exceptions.DatabaseError: DPY-4011: the database or network closed the connection
DPI-1080: connection was closed by ORA-03113
ORA-03113: end-of-file on communication channel
Process ID: 2163902
Session ID: 67 Serial number: 30878
Help: https://docs.oracle.com/error-help/db/ora-03113/
2025-07-19 11:40:54 [ERROR] fetch_oracle_customer: Failed to connect to Oracle DB: ORA-12170: Cannot connect. TCP connect timeout of 20s for host 192.168.5.45 port 1606. (CONNECTION_ID=vgythZkCR0ijj0AbXMTKJQ==)
Help: https://docs.oracle.com/error-help/db/ora-12170/
Traceback (most recent call last):
  File "C:\Users\delin\Documents\codes\pwani_finance\data_ingestion\fetch_oracle_customer.py", line 20, in connect
    self.connection = oracledb.connect(
                      ^^^^^^^^^^^^^^^^^
  File "C:\Users\delin\Documents\codes\pwani_finance\financePwani\Lib\site-packages\oracledb\connection.py", line 1276, in connect
    return conn_class(dsn=dsn, pool=pool, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\delin\Documents\codes\pwani_finance\financePwani\Lib\site-packages\oracledb\connection.py", line 653, in __init__
    impl.connect(params_impl, pool_impl)
  File "src/oracledb/impl/thick/connection.pyx", line 510, in oracledb.thick_impl.ThickConnImpl.connect
  File "src/oracledb/impl/thick/utils.pyx", line 474, in oracledb.thick_impl._raise_from_info
oracledb.exceptions.DatabaseError: ORA-12170: Cannot connect. TCP connect timeout of 20s for host 192.168.5.45 port 1606. (CONNECTION_ID=vgythZkCR0ijj0AbXMTKJQ==)
Help: https://docs.oracle.com/error-help/db/ora-12170/
2025-07-19 11:42:28 [INFO] fetch_oracle_customer: connection established
2025-07-19 12:08:48 [INFO] fetch_oracle_customer: fetched invoice data with shape (37388, 64)
2025-07-19 12:08:48 [INFO] fetch_oracle_customer: sucessfully returned data data columns are Index(['invoiceNumber', 'invoiceDate', 'customerNumber', 'invoiceGrossValue',
       'invoiceCurrencyCode', 'customerKey'],
      dtype='object') with shape (4902, 6)
2025-07-19 12:08:54 [ERROR] fetch_oracle_customer:  Failed to fetch customer data: ORA-00904: "NONE": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/
Traceback (most recent call last):
  File "C:\Users\delin\Documents\codes\pwani_finance\data_ingestion\fetch_oracle_customer.py", line 524, in fetch_customer_data
    df = self.cursor.execute(query)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\delin\Documents\codes\pwani_finance\financePwani\Lib\site-packages\oracledb\cursor.py", line 708, in execute
    impl.execute(self)
  File "src/oracledb/impl/thick/cursor.pyx", line 318, in oracledb.thick_impl.ThickCursorImpl.execute
  File "src/oracledb/impl/thick/utils.pyx", line 484, in oracledb.thick_impl._raise_from_odpi
  File "src/oracledb/impl/thick/utils.pyx", line 474, in oracledb.thick_impl._raise_from_info
oracledb.exceptions.DatabaseError: ORA-00904: "NONE": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/
